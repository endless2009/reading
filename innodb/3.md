## MySQL技术内幕innodb存储引擎读书笔记（三）
#### latch与lock
latch和lock最大的区别在于，latch是为了保护线程并发过程的资源，lock则是用来保护事务的锁。这里主要讨论后者。
### 1 Innodb的锁


#### 1.1 锁的类型
##### 行级锁
Innodb存储引擎有两种行级锁
- 共享锁(S Lock)：又称读锁
- 排它锁(X Lock)：又称行锁

||X |S |
|--|--|--|
|X |不兼容|不兼容|
|S |不兼容|兼容|

##### 意向锁
- 意向共享锁(IS Lock)：又称读锁
- 意向排它锁(IX Lock)：又称行锁


> 意向锁是表级锁，意向锁之间不会发生冲突，并且不会阻塞除全表扫以外的任何请求。

||IS|IX|S|X|
|--|--|--|--|--|
|IS|兼容|兼容|兼容|不兼容|
|IX|兼容|兼容|不兼容|不兼容|
|S|兼容|不兼容|兼容|不兼容|
|X|不兼容|不兼容|不兼容|不兼容|

> 注：以上的排它共享指的是表锁，意向锁不会与行级锁互斥。

###### 意向锁的作用

当一个事务要求加表锁时，需要扫描全表去发现有无被锁定的行，但是有了意向锁，可以省略很多扫描过程，直接发现互斥关系。
